# ETL basics (fetchmany)

## Что делает скрипт
- Читает данные из PostgreSQL (northwind)
- Забирает строки батчами через fetchmany(BATCH_SIZE) (экономит память)
- Проверяет/портит данные (генерация bad rows)
- Делит строки на good / bad
- Пишет результат и статистику в лог

## Почему fetchmany
- Не тянем всю таблицу в память
- Управляем размером батча (скорость/память)
- Удобно логировать прогресс

## Good / Bad rows
Идея:
- good: строка проходит проверки и может быть загружена дальше
- bad: строка нарушает правила (тип, формат, NULL где нельзя и т.д.)
Bad строки не ломают пайплайн — мы их откладываем и считаем

## Что логировать минимум
- сколько строк прочитано всего
- сколько good / bad
- причины bad (по типам ошибок)
- время выполнения и скорость (rows/sec)
